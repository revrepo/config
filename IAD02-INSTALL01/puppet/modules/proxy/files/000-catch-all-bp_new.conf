#
# This file is managed by Rev Puppet service as described on Wiki
# page https://revwiki.atlassian.net/wiki/display/OP/Puppet+Centralized+Configuration+Management+System
# Please don't modify the file on the Puppet client server since your changes will be overwritten on the next
# Puppet agent run on the server.
#

#
# "Catch all" configuration for BP server
#


#
# HTTP Service
#

<VirtualHost *:80>
    Redirect 503 /
    ErrorDocument 503 "No such site. Check the URL spelling."

    <IfModule rev_traffic_counter_module>
    	# Make sure the Rev traffic counter doesn't count error domains
	RevTrafficCounterEnabled Off	
    </IfModule>
</VirtualHost>

#
# HTTPS Service
#

<VirtualHost *:443>
    Redirect 503 /
    ErrorDocument 503 "No such site. Check the URL spelling."

    # Begin SSL setup (no proxy)
    SSLEngine On
    # Disable SSLv2/3 because of SNI, which requires TLS
    SSLProtocol All -SSLv2 -SSLv3
    # Mitigate CRIME attack
    SSLCompression off
    # Use stronger ciphers, which may mitigate BEAST attacks
    SSLHonorCipherOrder on
    SSLCipherSuite "EECDH+ECDSA+AESGCM EECDH+aRSA+AESGCM EECDH+ECDSA+SHA384 EECDH+ECDSA+SHA256 EECDH+aRSA+SHA384 EECDH+aRSA+SHA256 EECDH+aRSA+RC4 EECDH EDH+aRSA 3DES RC4 !aNULL !eNULL !LOW !MD5 !EXP !PSK !SRP !DSS +3DES 3DES +RC4 RC4"
    SSLCACertificateFile /opt/revsw-config/apache/generic-site/certs/ca-bundle.crt
    SSLCertificateFile /opt/revsw-config/apache/generic-site/certs/server.crt
    SSLCertificateKeyFile /opt/revsw-config/apache/generic-site/certs/server.key
    # End SSL setup

    <IfModule rev_traffic_counter_module>
    	# Make sure the Rev traffic counter doesn't count error domains
    	RevTrafficCounterEnabled Off
    </IfModule>
</VirtualHost>
